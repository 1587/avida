ADD_CUSTOM_COMMAND(
  OUTPUT
    cPopulation_construct_event_auto.ci
    cPopulation_descr.ci
    cPopulation_descr.hi
    cPopulation_enums_auto.ci
    cPopulation_name2enum_auto.ci
    cPopulation_process_auto.ci
  COMMAND perl
  ARGS
    ${PROJECT_SOURCE_DIR}/source/event/make_events.pl
    ${PROJECT_SOURCE_DIR}/source/event/cPopulation
  MAIN_DEPENDENCY ${PROJECT_SOURCE_DIR}/source/event/cPopulation.events
  COMMENT
    This is a somewhat ugly hack to build the autogenerated code.
    We pretend that the autogenerated code is actually a program, then
    make builds it correctly. Any other way leads to unnecessary 
    recompilation of libevent.a even if nothing has changed.
)

SET(libevent_a_SOURCES
  event.cc
  event_factory.cc
  event_factory_manager.cc
  event_list.cc
  event_list_entry.cc
  event_list_iterator.cc
  event_triggers.cc
  population_event.cc
  population_event_factory.cc
)

SET_SOURCE_FILES_PROPERTIES(population_event_factory.cc
  PROPERTIES
    OBJECT_DEPENDS cPopulation_construct_event_auto.ci
    OBJECT_DEPENDS cPopulation_enums_auto.ci
    OBJECT_DEPENDS cPopulation_name2enum_auto.ci
    OBJECT_DEPENDS cPopulation_process_auto.ci
)

INCLUDE_DIRECTORIES(${ALL_INC_DIRS})

ADD_LIBRARY(event ${libevent_a_SOURCES})
